<div class="feature-container">
  <div class="feature-header">
    <div class="title-area">
      <div class="page-title">
        <span class="feature-icon"><i class="fas fa-clipboard-check"></i></span>
        <h1>Instruments Verification</h1>
      </div>
      <p class="breadcrumb">
        <span class="crumb"><i class="fas fa-home"></i> Dashboard</span>
        <span class="separator">></span>
        <span class="crumb current">Instruments Verification</span>
        <span class="surgery-badge" *ngIf="selectedSurgery">{{ selectedSurgery.name }}</span>
      </p>
    </div>
    <div class="button-group">
      <button class="btn btn-secondary" routerLink="/dashboard">
        <i class="fas fa-arrow-left"></i> Back to Dashboard
      </button>
    </div>
  </div>
  
  <div class="feature-content">
    <!-- Surgery selection UI is now hidden since this is handled in dashboard -->
    <div class="surgery-selector" *ngIf="!selectedSurgery">
      <div class="notification-card">
        <div class="icon">ℹ️</div>
        <div class="message">
          <h3>No Surgery Selected</h3>
          <p>Please return to the dashboard and select a surgery to continue.</p>
          <button class="btn btn-primary" routerLink="/dashboard">Go to Dashboard</button>
        </div>
      </div>
    </div>
    
    <div class="surgery-details" *ngIf="selectedSurgery">
      <div class="surgery-header">
        <div class="surgery-info">
          <h2>{{ selectedSurgery.name }}</h2>
          <p>{{ selectedSurgery.description }}</p>
        </div>
        <button class="btn btn-outline" routerLink="/dashboard">Change Surgery</button>
      </div>
      
      <!-- All tables in one compact layout -->
      <div class="instruments-dashboard">
        <!-- Summary stats at the top -->
        <div class="stats-container">
          <div class="stat-card">
            <div class="stat-number">{{ selectedSurgery.requiredInstruments.length }}</div>
            <div class="stat-label">Total Instruments</div>
          </div>
          <div class="stat-card success">
            <div class="stat-number">{{ getInstrumentsInRoom().length }}</div>
            <div class="stat-label">In Room</div>
          </div>
          <div class="stat-card danger">
            <div class="stat-number">{{ getInstrumentsNotInRoom().length }}</div>
            <div class="stat-label">Missing</div>
          </div>
        </div>
        
        <!-- Status indicator -->
        <div class="status-indicator" [class.complete]="getInstrumentsNotInRoom().length === 0">
          <div class="indicator-icon">{{ getInstrumentsNotInRoom().length === 0 ? '✓' : '⚠️' }}</div>
          <div class="indicator-text">
            {{ getInstrumentsNotInRoom().length === 0 ? 'All instruments verified' : 'Missing instruments' }}
          </div>
        </div>
        
        <!-- All instruments in one compact table -->
        <div class="table-section">
          <h3>Instrument Verification List</h3>
          <div class="table-container compact">
            <table class="instruments-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Instrument Name</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let instrument of selectedSurgery.requiredInstruments">
                  <td class="id-column">{{ instrument.id }}</td>
                  <td>{{ instrument.name }}</td>
                  <td [ngClass]="{'status-present': instrument.inRoom, 'status-missing': !instrument.inRoom}">
                    {{ instrument.inRoom ? 'VERIFIED ✓' : 'MISSING ⚠️' }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="maintenance-dashboard">

  <!-- Main Content -->
  <div class="dashboard-content">
    <div class="content-header">
      <div class="title-section">
        <h2>Hospital Equipment Management</h2>
        <p>Monitor equipment status and access predictive maintenance analytics</p>
      </div>
      <div class="actions-section">
        <button class="refresh-btn" (click)="refreshAllData()">
          <i class="fas fa-sync-alt"></i> Refresh Data
        </button>
      </div>
    </div>

    <!-- Dashboard Grid Layout -->
    <div class="dashboard-grid">
      <!-- Left Column - Equipment Requests -->
      <section class="equipment-requests card">
        <div class="card-header">
          <div class="header-title">
            <i class="fas fa-clipboard-list"></i>
            <h3>Equipment Requests</h3>
            <span class="badge" *ngIf="hasNewRequests">New</span>
          </div>
        </div>
        
        <div class="card-body">
          <!-- Loading state -->
          <div *ngIf="requestsLoading" class="loading-state">
            <i class="fas fa-circle-notch fa-spin"></i>
            <span>Loading requests...</span>
          </div>
          
          <!-- Empty state -->
          <div *ngIf="!requestsLoading && equipmentRequests.length === 0" class="empty-state">
            <i class="fas fa-inbox"></i>
            <span>No pending equipment requests at this time.</span>
            <p class="empty-note">New requests will appear here automatically</p>
          </div>
          
          <!-- Request List -->
          <div *ngIf="!requestsLoading && equipmentRequests.length > 0" class="request-list">
            <div *ngFor="let request of equipmentRequests" 
                 class="request-item" 
                 [ngClass]="{'priority': request.status === 'requested'}">
              
              <div class="request-header">
                <span class="equipment-name">{{ request.equipment && request.equipment.name || 'Equipment' }}</span>
                <span class="status-pill" [ngClass]="request.status">
                  <i class="fas" [ngClass]="{
                    'fa-clock': request.status === 'requested',
                    'fa-check-circle': request.status === 'approved',
                    'fa-times-circle': request.status === 'rejected',
                    'fa-tools': request.status === 'maintenance',
                    'fa-truck': request.status === 'in_use',
                    'fa-undo': request.status === 'returned'
                  }"></i>
                  {{ request.status | titlecase }}
                </span>
              </div>
              
              <div class="request-details">
                <div class="detail-row">
                  <span class="label">Surgery ID:</span>
                  <span class="value">{{ request.operation_session || 'N/A' }}</span>
                </div>
                <div class="detail-row">
                  <span class="label">Equipment ID:</span>
                  <span class="value">{{ request.equipment && request.equipment.equipment_id || 'N/A' }}</span>
                </div>
                <div class="detail-row">
                  <span class="label">Requested:</span>
                  <span class="value">{{ request.check_out_time | date:'short' }}</span>
                </div>
              </div>
              
              <div class="request-actions">
                <!-- Actions for requested equipment -->
                <div *ngIf="checkStatus(request, 'requested')" class="action-group">
                  <button class="btn-success" *ngIf="request.id !== undefined" (click)="approveRequest(request.id)">
                    <i class="fas fa-check"></i> Approve
                  </button>
                  <button class="btn-danger" *ngIf="request.id !== undefined" (click)="rejectRequest(request.id)">
                    <i class="fas fa-times"></i> Reject
                  </button>
                </div>
                
                <!-- Actions for approved equipment -->
                <div *ngIf="checkStatus(request, 'approved')" class="action-group">
                  <button class="btn-primary" *ngIf="request.id !== undefined" (click)="fulfillRequest(request.id)">
                    <i class="fas fa-truck-loading"></i> Mark as Delivered
                  </button>
                </div>
                
                <!-- Status indicators for completed actions -->
                <div *ngIf="checkStatus(request, 'in_use')" class="action-complete">
                  <i class="fas fa-check-circle"></i> Equipment delivered
                </div>
                
                <div *ngIf="checkStatus(request, 'rejected')" class="action-complete rejected">
                  <i class="fas fa-times-circle"></i> Request rejected
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Right Column - Tools & Navigation -->
      <div class="tools-column">
        <!-- Tools Section - Maintenance Features -->
        <section class="card maintenance-features">
          <div class="card-header">
            <h3>
              <i class="fas fa-tools"></i>
              Maintenance Features
            </h3>
          </div>
          <div class="card-body">
            <div class="features-grid">
              <div class="feature-card" (click)="navigateToFeature('equipment-overview')">
                <div class="feature-icon">
                  <i class="fas fa-tools"></i>
                </div>
                <div class="feature-content">
                  <h4>Equipment Overview</h4>
                  <p>Monitor all hospital equipment status, location, and maintenance needs</p>
                </div>
              </div>
              
              <div class="feature-card" (click)="navigateToFeature('predictive-maintenance')">
                <div class="feature-icon">
                  <i class="fas fa-chart-line"></i>
                </div>
                <div class="feature-content">
                  <h4>Predictive Maintenance</h4>
                  <p>AI-powered maintenance predictions and recommendations</p>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
</div>

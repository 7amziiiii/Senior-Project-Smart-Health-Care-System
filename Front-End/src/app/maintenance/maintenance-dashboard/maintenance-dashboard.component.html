<div class="maintenance-dashboard">
  <!-- Top Navigation -->
  <nav class="main-nav">
    <div class="nav-content">
      <div class="nav-brand">
        <i class="fas fa-hospital-alt"></i>
        <h1>Maintenance Dashboard</h1>
      </div>
      <div class="nav-actions">
        <span class="user-name">{{ username }}</span>
        <button class="btn-logout" (click)="logout()">
          <i class="fas fa-sign-out-alt"></i>
          Logout
        </button>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="dashboard-content">
    <div class="content-header">
      <h2>Hospital Equipment Management</h2>
      <p>Monitor equipment status, handle maintenance requests, and access predictive maintenance analytics</p>
    </div>

    <!-- Dashboard Grid Layout -->
    <div class="dashboard-grid">
      <!-- Left Column - Equipment Requests -->
      <section class="equipment-requests card">
        <div class="card-header">
          <h3>
            <i class="fas fa-clipboard-list"></i>
            Equipment Requests
          </h3>
          <span class="badge" *ngIf="hasNewRequests">New</span>
          <div class="header-actions">
            <button class="btn-refresh" (click)="loadPendingRequests()">
              <i class="fa fa-sync"></i> Refresh
            </button>
          </div>
        </div>
        
        <div class="card-body">
          <!-- Loading state -->
          <div *ngIf="requestsLoading" class="loading-state">
            <i class="fas fa-circle-notch fa-spin"></i>
            <span>Loading requests...</span>
          </div>
          
          <!-- Empty state -->
          <div *ngIf="!requestsLoading && equipmentRequests.length === 0" class="empty-state">
            <i class="fa fa-info-circle"></i>
            <span>No pending equipment requests at this time.</span>
            <button class="btn btn-refresh" (click)="loadPendingRequests()">
              <i class="fa fa-sync"></i> Refresh
            </button>
          </div>
          
          <!-- Request List -->
          <div *ngIf="!requestsLoading && equipmentRequests.length > 0" class="request-list">
            <div *ngFor="let request of equipmentRequests" 
                 class="request-item" 
                 [ngClass]="{'priority': request.status === 'requested'}">
              
              <div class="request-header">
                <span class="equipment-name">{{ request.equipment && request.equipment.name || 'Equipment' }}</span>
                <span class="status-pill" [ngClass]="request.status">
                  <i class="fas" [ngClass]="{
                    'fa-clock': request.status === 'requested',
                    'fa-check-circle': request.status === 'approved',
                    'fa-times-circle': request.status === 'rejected',
                    'fa-tools': request.status === 'maintenance',
                    'fa-truck': request.status === 'in_use',
                    'fa-undo': request.status === 'returned'
                  }"></i>
                  {{ request.status | titlecase }}
                </span>
              </div>
              
              <div class="request-details">
                <div class="detail-row">
                  <span class="label">Surgery ID:</span>
                  <span class="value">{{ request.operation_session || 'N/A' }}</span>
                </div>
                <div class="detail-row">
                  <span class="label">Equipment ID:</span>
                  <span class="value">{{ request.equipment && request.equipment.equipment_id || 'N/A' }}</span>
                </div>
                <div class="detail-row">
                  <span class="label">Requested:</span>
                  <span class="value">{{ request.check_out_time | date:'short' }}</span>
                </div>
              </div>
              
              <div class="request-actions">
                <!-- Actions for requested equipment -->
                <div *ngIf="checkStatus(request, 'requested')" class="action-group">
                  <button class="btn-success" *ngIf="request.id !== undefined" (click)="approveRequest(request.id)">
                    <i class="fas fa-check"></i> Approve
                  </button>
                  <button class="btn-danger" *ngIf="request.id !== undefined" (click)="rejectRequest(request.id)">
                    <i class="fas fa-times"></i> Reject
                  </button>
                </div>
                
                <!-- Actions for approved equipment -->
                <div *ngIf="checkStatus(request, 'approved')" class="action-group">
                  <button class="btn-primary" *ngIf="request.id !== undefined" (click)="fulfillRequest(request.id)">
                    <i class="fas fa-truck-loading"></i> Mark as Delivered
                  </button>
                </div>
                
                <!-- Status indicators for completed actions -->
                <div *ngIf="checkStatus(request, 'in_use')" class="action-complete">
                  <i class="fas fa-check-circle"></i> Equipment delivered
                </div>
                
                <div *ngIf="checkStatus(request, 'rejected')" class="action-complete rejected">
                  <i class="fas fa-times-circle"></i> Request rejected
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Right Column - Tools & Navigation -->
      <div class="tools-column">
        <!-- Tools Section -->
        <section class="maintenance-tools card">
          <div class="card-header">
            <h3>
              <i class="fas fa-tools"></i>
              Maintenance Tools
            </h3>
          </div>
          <div class="card-body">
            <div class="tools-grid">
              <div *ngFor="let feature of features" 
                   class="tool-card" 
                   (click)="navigateToFeature(feature.id)">
                <div class="tool-icon">
                  <i class="fas {{ feature.icon }}"></i>
                </div>
                <div class="tool-content">
                  <h4>{{ feature.title }}</h4>
                  <p>{{ feature.description }}</p>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
</div>
